"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[454],{454:function(e,n,t){t.r(n),t.d(n,{default:function(){return ue}});var a=t(4880),r=t(885),s=t(2791),i=t(2930),l=t(1413),c=t(1933),o=t(6436),d=t(184),u=(0,s.createContext)(i.vv),m=function(e){var n=e.children,t=(0,s.useState)(i.vv.state),a=(0,r.Z)(t,2),c=a[0],o=a[1];return(0,d.jsx)(u.Provider,{value:{state:c,updateState:function(e){var n=(0,l.Z)((0,l.Z)({},c),e);o(n)}},children:n})},f=function(){return(0,s.useContext)(u)},p=(0,i.gl)(i.B2),h=function(e){var n=e.children,t=f().state,a=(0,s.useState)((0,i.gJ)(t)),l=(0,r.Z)(a,2),u=l[0],m=l[1],h=(0,s.useMemo)((function(){return(0,i.gJ)(t)}),[t]);(0,s.useEffect)((function(){u!==h&&m(h)}),[h]);var x=(0,c.useQuery)("".concat(i.vb.USERS_LIST,"-").concat(u),(function(){return(0,o.Rf)(u)}),{cacheTime:0,keepPreviousData:!0,refetchOnWindowFocus:!1}),v=x.isFetching,b=x.refetch,j=x.data;return(0,d.jsx)(p.Provider,{value:{isLoading:v,refetch:b,response:j,query:u},children:n})},x=function(){return(0,s.useContext)(p)},v=function(){var e=x().response;return e&&(null===e||void 0===e?void 0:e.data)||[]},b=function(){return x().isLoading},j=(0,s.createContext)(i.px),g=function(e){var n=e.children,t=(0,s.useState)(i.px.selected),a=(0,r.Z)(t,2),l=a[0],c=a[1],o=(0,s.useState)(i.px.itemIdForUpdate),u=(0,r.Z)(o,2),m=u[0],f=u[1],p=x().isLoading,h=v(),b=(0,s.useMemo)((function(){return(0,i.Qx)(p,h)}),[p,h]),g=(0,s.useMemo)((function(){return(0,i.HX)(h,l)}),[h,l]);return(0,d.jsx)(j.Provider,{value:{selected:l,itemIdForUpdate:m,setItemIdForUpdate:f,disabled:b,isAllSelected:g,onSelect:function(e){(0,i.G8)(e,l,c)},onSelectAll:function(){(0,i.ir)(g,c,h)},clearSelected:function(){c([])}},children:n})},N=function(){return(0,s.useContext)(j)},k=t(6492),w=function(){var e=f().updateState,n=x().isLoading,t=(0,s.useState)(),a=(0,r.Z)(t,2),c=a[0],o=a[1],u=(0,s.useState)(),m=(0,r.Z)(u,2),p=m[0],h=m[1];(0,s.useEffect)((function(){k.Mn.reinitialization()}),[]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{disabled:n,type:"button",className:"btn btn-light-primary me-3","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end",children:[(0,d.jsx)(i.D8,{path:"/media/icons/duotune/general/gen031.svg",className:"svg-icon-2"}),"Filter"]}),(0,d.jsxs)("div",{className:"menu menu-sub menu-sub-dropdown w-300px w-md-325px","data-kt-menu":"true",children:[(0,d.jsx)("div",{className:"px-7 py-5",children:(0,d.jsx)("div",{className:"fs-5 text-dark fw-bolder",children:"Filter Options"})}),(0,d.jsx)("div",{className:"separator border-gray-200"}),(0,d.jsxs)("div",{className:"px-7 py-5","data-kt-user-table-filter":"form",children:[(0,d.jsxs)("div",{className:"mb-10",children:[(0,d.jsx)("label",{className:"form-label fs-6 fw-bold",children:"Role:"}),(0,d.jsxs)("select",{className:"form-select form-select-solid fw-bolder","data-kt-select2":"true","data-placeholder":"Select option","data-allow-clear":"true","data-kt-user-table-filter":"role","data-hide-search":"true",onChange:function(e){return o(e.target.value)},value:c,children:[(0,d.jsx)("option",{value:""}),(0,d.jsx)("option",{value:"Administrator",children:"Administrator"}),(0,d.jsx)("option",{value:"Analyst",children:"Analyst"}),(0,d.jsx)("option",{value:"Developer",children:"Developer"}),(0,d.jsx)("option",{value:"Support",children:"Support"}),(0,d.jsx)("option",{value:"Trial",children:"Trial"})]})]}),(0,d.jsxs)("div",{className:"mb-10",children:[(0,d.jsx)("label",{className:"form-label fs-6 fw-bold",children:"Last login:"}),(0,d.jsxs)("select",{className:"form-select form-select-solid fw-bolder","data-kt-select2":"true","data-placeholder":"Select option","data-allow-clear":"true","data-kt-user-table-filter":"two-step","data-hide-search":"true",onChange:function(e){return h(e.target.value)},value:p,children:[(0,d.jsx)("option",{value:""}),(0,d.jsx)("option",{value:"Yesterday",children:"Yesterday"}),(0,d.jsx)("option",{value:"20 mins ago",children:"20 mins ago"}),(0,d.jsx)("option",{value:"5 hours ago",children:"5 hours ago"}),(0,d.jsx)("option",{value:"2 days ago",children:"2 days ago"})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,d.jsx)("button",{type:"button",disabled:n,onClick:function(){e((0,l.Z)({filter:{role:c,last_login:p}},i.Xw))},className:"btn btn-light btn-active-light-primary fw-bold me-2 px-6","data-kt-menu-dismiss":"true","data-kt-user-table-filter":"reset",children:"Reset"}),(0,d.jsx)("button",{disabled:n,type:"button",onClick:function(){e((0,l.Z)({filter:void 0},i.Xw))},className:"btn btn-primary fw-bold px-6","data-kt-menu-dismiss":"true","data-kt-user-table-filter":"filter",children:"Apply"})]})]})]})]})},_=t(8472),y=function(e){var n=e.csvData,t=e.fileName;return(0,d.jsxs)("button",{type:"button",className:"btn btn-light-primary me-3",children:[(0,d.jsx)(i.D8,{path:"/media/icons/duotune/arrows/arr078.svg",className:"svg-icon-2"}),(0,d.jsx)(_.CSVLink,{data:n,filename:t,children:"Export"})]})},S=function(){var e=N().setItemIdForUpdate,n=v();return(0,d.jsxs)("div",{className:"d-flex justify-content-end","data-kt-user-table-toolbar":"base",children:[(0,d.jsx)(w,{}),(0,d.jsx)(y,{csvData:n,fileName:"staff"}),(0,d.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){e(null)},children:[(0,d.jsx)(i.D8,{path:"/media/icons/duotune/arrows/arr075.svg",className:"svg-icon-2"}),"Add Staff"]})]})},Z=t(4165),C=t(5861),F=t(1830),P=t.n(F),I=function(){var e=N(),n=e.selected,t=e.clearSelected,a=(0,c.useQueryClient)(),r=x().query,s=(0,c.useMutation)((function(){return(0,o.mX)(n)}),{onSuccess:function(){a.invalidateQueries(["".concat(i.vb.USERS_LIST,"-").concat(r)]),t()}});return(0,d.jsxs)("div",{className:"d-flex justify-content-end align-items-center",children:[(0,d.jsxs)("div",{className:"fw-bolder me-5",children:[(0,d.jsx)("span",{className:"me-2",children:n.length})," Selected"]}),(0,d.jsx)("button",{type:"button",className:"btn btn-danger",onClick:(0,C.Z)((0,Z.Z)().mark((function e(){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){var e=(0,C.Z)((0,Z.Z)().mark((function e(n){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isConfirmed){e.next=3;break}return e.next=3,s.mutateAsync();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),children:"Delete Selected"})]})},E=function(){var e=f().updateState,n=(0,s.useState)(""),t=(0,r.Z)(n,2),a=t[0],c=t[1],o=(0,i.Nr)(a,150);return console.log(o,"debounceSearchTerm"),(0,s.useEffect)((function(){void 0!==o&&void 0!==a&&e((0,l.Z)({search:o},i.Xw))}),[o]),(0,d.jsx)("div",{className:"card-title",children:(0,d.jsxs)("div",{className:"d-flex align-items-center position-relative my-1",children:[(0,d.jsx)(i.D8,{path:"/media/icons/duotune/general/gen021.svg",className:"svg-icon-1 position-absolute ms-6"}),(0,d.jsx)("input",{type:"text","data-kt-user-table-filter":"search",className:"form-control form-control-solid w-250px ps-14",placeholder:"Search Staff",value:a,onChange:function(e){return c(e.target.value)}})]})})},A=function(){var e=N().selected;return(0,d.jsxs)("div",{className:"card-header border-0 pt-6",children:[(0,d.jsx)(E,{}),(0,d.jsx)("div",{className:"card-toolbar",children:e.length>0?(0,d.jsx)(I,{}):(0,d.jsx)(S,{})})]})},q=t(1358),L=function(e){var n=e.column;return(0,d.jsx)(d.Fragment,{children:n.Header&&"string"===typeof n.Header?(0,d.jsx)("th",(0,l.Z)((0,l.Z)({},n.getHeaderProps()),{},{children:n.render("Header")})):n.render("Header")})},U=t(8182),B=function(e){var n=e.row;return(0,d.jsx)("tr",(0,l.Z)((0,l.Z)({},n.getRowProps()),{},{children:n.cells.map((function(e){return(0,d.jsx)("td",(0,l.Z)((0,l.Z)({},e.getCellProps()),{},{className:(0,U.Z)({"text-end min-w-100px":"actions"===e.column.id}),children:e.render("Cell")}))}))}))},D=function(e){var n,t=e.user,a=N().setItemIdForUpdate,r=function(){a(t.id)};return(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("div",{className:"symbol symbol-circle symbol-50px overflow-hidden me-3",children:(0,d.jsx)("a",{onClick:r,style:{cursor:"pointer"},children:null!==t&&void 0!==t&&t.profile_image?(0,d.jsx)("div",{className:"symbol-label",children:(0,d.jsx)("img",{src:null===t||void 0===t?void 0:t.profile_image,alt:null===t||void 0===t?void 0:t.first_name,className:"w-100"})}):(0,d.jsx)("div",{className:(0,U.Z)("symbol-label fs-3","bg-light-warning","text-warning"),children:null===t||void 0===t||null===(n=t.first_name)||void 0===n?void 0:n.charAt(0)})})}),(0,d.jsx)("div",{className:"d-flex flex-column",children:(0,d.jsxs)("a",{onClick:r,style:{cursor:"pointer"},className:"text-gray-800 text-hover-primary mb-1",children:[t.first_name," ",t.last_name]})})]})},R=function(e){var n=e.phone_number;return(0,d.jsx)("div",{className:"d-flex align-items-center",children:(0,d.jsx)("div",{className:"d-flex flex-column",children:n})})},T=function(e){var n=e.admin;return(0,d.jsxs)(d.Fragment,{children:[" ",n?(0,d.jsx)("div",{className:"badge badge-light-success fw-bolder",children:"Yes"}):(0,d.jsx)("div",{className:"badge badge-light-danger fw-bolder",children:"No"})]})},O=function(e){var n=e.id,t=N().setItemIdForUpdate,a=x().query,r=(0,c.useQueryClient)();(0,s.useEffect)((function(){k.Mn.reinitialization()}),[]);var l=(0,c.useMutation)((function(){return(0,o.h8)(n)}),{onSuccess:function(){P().fire({title:"Success!",text:"Staff Deleted!",icon:"success",confirmButtonText:"Okay"}),r.invalidateQueries(["".concat(i.vb.USERS_LIST,"-").concat(a)])}});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("a",{href:"#",className:"btn btn-light btn-active-light-primary btn-sm","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end",children:(0,d.jsx)("i",{className:"bi bi-three-dots-vertical fs-5"})}),(0,d.jsxs)("div",{className:"menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-125px py-4","data-kt-menu":"true",children:[(0,d.jsx)("div",{className:"menu-item px-3",children:(0,d.jsx)("a",{className:"menu-link px-3",onClick:function(){t(n)},children:"Edit"})}),(0,d.jsx)("div",{className:"menu-item px-3",children:(0,d.jsx)("a",{className:"menu-link px-3","data-kt-users-table-filter":"delete_row",onClick:(0,C.Z)((0,Z.Z)().mark((function e(){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){var e=(0,C.Z)((0,Z.Z)().mark((function e(n){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isConfirmed){e.next=3;break}return e.next=3,l.mutateAsync();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),children:"Delete"})})]})]})},H=function(e){var n=e.id,t=N(),a=t.selected,r=t.onSelect,i=(0,s.useMemo)((function(){return a.includes(n)}),[n,a]);return(0,d.jsx)("div",{className:"form-check form-check-sm form-check-custom form-check-solid",children:(0,d.jsx)("input",{className:"form-check-input",type:"checkbox","data-kt-check":i,"data-kt-check-target":"#kt_table_users .form-check-input",checked:i,onChange:function(){return r(n)}})})},M=function(e){var n=e.className,t=e.title,a=e.tableProps,r=a.column.id,c=f(),o=c.state,u=c.updateState,m=(0,s.useMemo)((function(){return o.sort&&o.sort===r}),[o,r]),p=(0,s.useMemo)((function(){return o.order}),[o]);return(0,d.jsx)("th",(0,l.Z)((0,l.Z)({},a.column.getHeaderProps()),{},{className:(0,U.Z)(n,m&&void 0!==p&&"table-sort-".concat(p)),style:{cursor:"pointer"},onClick:function(){if("actions"!==r&&"selection"!==r)if(m){if(m&&void 0!==p){if("asc"===p)return void u((0,l.Z)({sort:r,order:"desc"},i.Xw));u((0,l.Z)({sort:void 0,order:void 0},i.Xw))}}else u((0,l.Z)({sort:r,order:"asc"},i.Xw))},children:t}))},V=function(e){var n=e.tableProps,t=N(),a=t.isAllSelected,r=t.onSelectAll;return(0,d.jsx)("th",(0,l.Z)((0,l.Z)({},n.column.getHeaderProps()),{},{className:"w-10px pe-2",children:(0,d.jsx)("div",{className:"form-check form-check-sm form-check-custom form-check-solid me-3",children:(0,d.jsx)("input",{className:"form-check-input",type:"checkbox","data-kt-check":a,"data-kt-check-target":"#kt_table_users .form-check-input",checked:a,onChange:r})})}))},X=function(e){var n=e.email;return(0,d.jsx)("div",{className:"d-flex align-items-center",children:(0,d.jsx)("div",{className:"d-flex flex-column",children:n})})},Y=[{Header:function(e){return(0,d.jsx)(V,{tableProps:e})},id:"selection",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(H,{id:n.data[n.row.index].id})}},{Header:function(e){return(0,d.jsx)(M,{tableProps:e,title:"Name",className:"min-w-125px"})},id:"name",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(D,{user:n.data[n.row.index]})}},{Header:function(e){return(0,d.jsx)(M,{tableProps:e,title:"Email",className:"min-w-125px"})},id:"email",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(X,{email:n.data[n.row.index].email})}},{Header:function(e){return(0,d.jsx)(M,{tableProps:e,title:"Phone Number",className:"min-w-125px"})},id:"phone_number",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(R,{phone_number:n.data[n.row.index].phone_number})}},{Header:function(e){return(0,d.jsx)(M,{tableProps:e,title:"Is Admin",className:"min-w-125px"})},id:"admin",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(T,{admin:n.data[n.row.index].admin})}},{Header:function(e){return(0,d.jsx)(M,{tableProps:e,title:"Actions",className:"text-end min-w-100px"})},id:"actions",Cell:function(e){var n=Object.assign({},e);return(0,d.jsx)(O,{id:n.data[n.row.index].id})}}],Q=function(){return(0,d.jsx)("div",{style:(0,l.Z)((0,l.Z)({},{borderRadius:"0.475rem",boxShadow:"0 0 50px 0 rgb(82 63 105 / 15%)",backgroundColor:"#fff",color:"#7e8299",fontWeight:"500",margin:"0",width:"auto",padding:"1rem 2rem",top:"calc(50% - 2rem)",left:"calc(50% - 4rem)"}),{},{position:"absolute",textAlign:"center"}),children:"Processing..."})},G=function(){var e,n=function(){var e=(0,l.Z)({links:[]},i.Xw),n=x().response;return n&&n.payload&&n.payload.pagination?n.payload.pagination:e}(),t=b(),a=f().updateState;return(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"}),(0,d.jsx)("div",{className:"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end",children:(0,d.jsx)("div",{id:"kt_table_users_paginate",children:(0,d.jsx)("ul",{className:"pagination",children:null===(e=n.links)||void 0===e?void 0:e.map((function(e){return(0,d.jsx)("li",{className:(0,U.Z)("page-item",{active:n.page===e.page,disabled:t,previous:"&laquo; Previous"===e.label,next:"Next &raquo;"===e.label}),children:(0,d.jsx)("a",{className:"page-link",onClick:function(){var r;(r=e.page)&&!t&&n.page!==r&&a({page:r,items_per_page:n.items_per_page||10})},dangerouslySetInnerHTML:{__html:e.label},style:{cursor:"pointer"}})},e.label)}))})})})]})},J=function(){var e=v(),n=b(),t=(0,s.useMemo)((function(){return e}),[e]),a=(0,s.useMemo)((function(){return Y}),[]),r=(0,q.useTable)({columns:a,data:t}),c=r.getTableProps,o=r.getTableBodyProps,u=r.headers,m=r.rows,f=r.prepareRow;return(0,d.jsxs)(i.mN,{className:"py-4",children:[(0,d.jsx)("div",{className:"table-responsive",children:(0,d.jsxs)("table",(0,l.Z)((0,l.Z)({id:"kt_table_users",className:"table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer"},c()),{},{children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{className:"text-start text-muted fw-bolder fs-7 text-uppercase gs-0",children:u.map((function(e){return(0,d.jsx)(L,{column:e},e.id)}))})}),(0,d.jsx)("tbody",(0,l.Z)((0,l.Z)({className:"text-gray-600 fw-bold"},o()),{},{children:m.length>0?m.map((function(e,n){return f(e),(0,d.jsx)(B,{row:e},"row-".concat(n,"-").concat(e.id))})):(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:7,children:(0,d.jsx)("div",{className:"d-flex text-center w-100 align-content-center justify-content-center",children:"No matching records found"})})})}))]}))}),(0,d.jsx)(G,{}),n&&(0,d.jsx)(Q,{})]})},z=function(){var e=N().setItemIdForUpdate;return(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h2",{className:"fw-bolder",children:"Add a Staff"}),(0,d.jsx)("div",{className:"btn btn-icon btn-sm btn-active-icon-primary","data-kt-users-modal-action":"close",onClick:function(){return e(void 0)},style:{cursor:"pointer"},children:(0,d.jsx)(i.D8,{path:"/media/icons/duotune/arrows/arr061.svg",className:"svg-icon-1"})})]})},W=t(5173),$=t(6863),K={id:void 0,first_name:"",last_name:"",email:"",phone_number:"",password:"",profile_image:null,admin:!1,role_id:null,permissions:[]},ee=[$.Ry({first_name:$.Z_().required("First name is required").label("first_name"),last_name:$.Z_().required("Last name is required").label("last_name"),email:$.Z_().email("Wrong email format").required("Email is required").label("email"),phone_number:$.Z_().length(10).matches(/^((\\+[1-9]{1,4}[ \\-]*)|(\\([0-9]{2,3}\\)[ \\-]*)|([0-9]{2,4})[ \\-]*)*?[0-9]{3,4}?[ \\-]*[0-9]{3,4}?$/,"Phone number is not valid").required("Phone number is required").label("Phone Number"),password:$.Z_().required("Password is required").label("password")}),$.Ry({role_id:$.Z_().required("Please select role").label("role")})],ne=t(1467),te=function(e){var n,t=e.setFieldValue,a=e.values,l=e.touched,c=(e.setFieldError,e.errors);console.log(l,"touched",c);var u=function(){var e=(0,C.Z)((0,Z.Z)().mark((function e(n){var t,r;return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=/\S+@\S+\.\S+/.test(n),""==n||!r||a.id){e.next=5;break}return e.next=5,(0,o.oP)(n).then((function(e){t="Email already exists"==e.data?e.data:null})).catch((function(e){console.log(e)}));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),m=(0,s.useState)(!1),f=(0,r.Z)(m,2),p=f[0],h=f[1];return(0,d.jsxs)("div",{className:"w-100",children:[(0,d.jsxs)("div",{className:"fv-row mb-7",children:[(0,d.jsx)("label",{className:"d-block form-label",children:"Avatar"}),(0,d.jsxs)("div",{className:"image-input image-input-outline","data-kt-image-input":"true",children:[(0,d.jsx)("div",{className:"",children:(0,d.jsx)("img",{src:null!==a&&void 0!==a&&null!==(n=a.profile_image)&&void 0!==n&&n.name?URL.createObjectURL(null===a||void 0===a?void 0:a.profile_image):null!=(null===a||void 0===a?void 0:a.profile_image)?null===a||void 0===a?void 0:a.profile_image:(0,i.BY)("/media/svg/avatars/blank.svg"),alt:"avatar",className:"image-input-wrapper w-125px h-125px"})}),(0,d.jsxs)("label",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change avatar",children:[(0,d.jsx)("i",{className:"bi bi-pencil-fill fs-7"}),(0,d.jsx)("input",{type:"file",name:"profile_image",accept:".png, .jpg, .jpeg",onChange:function(e){t("profile_image",e.currentTarget.files[0])}}),(0,d.jsx)("input",{type:"hidden",name:"avatar_remove"})]}),null!==a.profile_image&&(0,d.jsx)("button",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove avatar",type:"button",onClick:function(){return t("profile_image",null)},children:(0,d.jsx)("i",{className:"bi bi-x fs-2"})})]}),(0,d.jsx)("div",{className:"form-text",children:"Allowed file types: png, jpg, jpeg."})]}),(0,d.jsxs)("div",{className:"d-flex flex-wrap gap-5 mb-10",children:[(0,d.jsxs)("div",{className:"fv-row w-100 flex-md-root",children:[(0,d.jsx)("label",{className:"form-label required",children:"First Name"}),(0,d.jsx)(W.gN,{name:"first_name",className:"form-control mb-2",placeholder:"Enter First Name"}),(0,d.jsx)("div",{className:"text-danger mt-2",children:(0,d.jsx)(W.Bc,{name:"first_name"})})]}),(0,d.jsxs)("div",{className:"fv-row w-100 flex-md-root",children:[(0,d.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,d.jsx)("span",{className:"required",children:"Last Name"})}),(0,d.jsx)(W.gN,{name:"last_name",className:"form-control mb-2",placeholder:"Enter Last Name"}),(0,d.jsx)("div",{className:"text-danger mt-2",children:(0,d.jsx)(W.Bc,{name:"last_name"})})]})]}),(0,d.jsxs)("div",{className:"d-flex flex-wrap gap-5 mb-10",children:[(0,d.jsxs)("div",{className:"fv-row w-100 flex-md-root",children:[(0,d.jsx)("label",{className:"fs-6 fw-bold form-label required",children:"Email"}),(0,d.jsx)(W.gN,{name:"email",className:"form-control mb-2",placeholder:"Enter Valid Email",validate:u}),c.email?(0,d.jsx)("div",{className:"text-danger mt-2",children:c.email}):(0,d.jsx)("div",{className:"text-danger mt-2",children:(0,d.jsx)(W.Bc,{name:"email"})})]}),(0,d.jsxs)("div",{className:"fv-row w-100 flex-md-root",children:[(0,d.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,d.jsx)("span",{className:"required",children:"Phone Number"})}),(0,d.jsx)(W.gN,{name:"phone_number",type:"number",className:"form-control mb-2",placeholder:"Enter Valid Phone Number"}),(0,d.jsx)("div",{className:"text-danger mt-2",children:(0,d.jsx)(W.Bc,{name:"phone_number"})})]})]}),(0,d.jsxs)("div",{className:"fv-row mb-10",children:[(0,d.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,d.jsx)("span",{className:"required",children:"Password"})}),(0,d.jsxs)("div",{style:{flexDirection:"row",display:"flex"},className:"mb-2 gap-5",children:[(0,d.jsxs)("div",{className:"position-relative w-100",children:[(0,d.jsx)(W.gN,{name:"password",type:p?"text":"password",className:"form-control mb-2",placeholder:"Enter Strong Password Or Generate"}),(0,d.jsx)("button",{type:"button",onClick:function(){return h(!p)},className:"btn btn-sm btn-icon position-absolute translate-middle top-50 end-0 me-n2","data-kt-password-meter-control":"visibility",children:p?(0,d.jsx)("i",{className:"bi bi-eye fs-2"}):(0,d.jsx)("i",{className:"bi bi-eye-slash fs-2"})})]}),(0,d.jsx)("button",{type:"button",className:"btn btn-lg btn-light-primary w-50 p-0 fs-15",onClick:function(){t("password",Math.random().toString(36).slice(2))},children:"Generate Password"})]}),(0,d.jsx)(ne.Z,{password:null===a||void 0===a?void 0:a.password}),(0,d.jsx)("div",{className:"text-danger",children:(0,d.jsx)(W.Bc,{name:"password"})})]}),(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-15",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",name:"admin"}),(0,d.jsx)("span",{className:"form-check-label fs-15 fw-bold",children:"Administrator"})]})]})},ae=t(4942),re=function(e){var n=e.values,t=e.setFieldValue;console.log(n,"values");var a=(0,s.useState)([]),i=(0,r.Z)(a,2),c=i[0],u=i[1],m=(0,s.useState)([]),f=(0,r.Z)(m,2),p=f[0],h=f[1],x=(0,s.useState)(),v=(0,r.Z)(x,2),b=v[0],j=v[1];(0,s.useEffect)((function(){(0,o.Zu)().then((function(e){var n;n=e.data,u(n)})).catch((function(e){console.log(e,"err")})),(0,o.F3)().then((function(e){var t;t=e.data,n.role_id&&j(t.find((function(e){return e.id==n.role_id}))),h(t)})).catch((function(e){console.log(e,"err")}))}),[]),(0,s.useEffect)((function(){(null===b||void 0===b?void 0:b.permissions.length)>0&&void 0==n.id&&t("permissions",b.permissions)}),[b]);var g=function(e,a){var r=e.target,s=r.checked,i=r.name,c=n.permissions,o=null===c||void 0===c?void 0:c.findIndex((function(e){return e.permission_id==a}));-1!==o?c[o]=(0,l.Z)((0,l.Z)({},c[o]),{},(0,ae.Z)({},i,s)):null===c||void 0===c||c.push({permission_id:a,can_view:!("can_view"!=i||!s),can_view_own:!("can_view_own"!=i||!s),can_create:!("can_create"!=i||!s),can_edit:!("can_edit"!=i||!s),can_delete:!("can_delete"!=i||!s)}),t("permissions",c)};return(0,d.jsxs)("div",{className:"w-100",children:[(0,d.jsxs)("div",{className:"fv-row mb-10",children:[(0,d.jsx)("label",{className:"form-label required",children:"Role"}),(0,d.jsxs)(W.gN,{as:"select",name:"role_id",className:"form-select mb-2","data-control":"select2","data-hide-search":"true","data-placeholder":"Select an option",onChange:function(e){j(p.find((function(n){return n.id==e.target.value}))),t("role_id",parseInt(e.target.value))},children:[null==n.role_id&&(0,d.jsx)("option",{}),p.map((function(e,n){return(0,d.jsx)("option",{value:e.id,children:e.name},n)}))]}),(0,d.jsx)("div",{className:"text-danger mt-2",children:(0,d.jsx)(W.Bc,{name:"role_id"})})]}),(0,d.jsxs)("div",{className:"mb-10 fv-row",children:[(0,d.jsx)("label",{className:"fw-bold fs-6 mb-2",children:"Permissions"}),(0,d.jsx)("div",{className:"table-responsive",children:(0,d.jsx)("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:(0,d.jsx)("tbody",{className:"text-gray-600 fw-bold",children:null===c||void 0===c?void 0:c.map((function(e,t){var a,r,s,i,l,c,o,u,m,f,p,h,x,v;return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"text-gray-800",children:null===e||void 0===e?void 0:e.name}),(0,d.jsx)("td",{style:{paddingLeft:35},children:(0,d.jsxs)("div",{className:"d-flex",children:[(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-10",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",checked:null===(a=n.permissions)||void 0===a||null===(r=a.find((function(n){return n.permission_id==e.id})))||void 0===r?void 0:r.can_view,disabled:1==(null===(s=n.permissions)||void 0===s||null===(i=s.find((function(n){return n.permission_id==e.id})))||void 0===i?void 0:i.can_view_own),name:"can_view",onChange:function(n){return g(n,e.id)}}),(0,d.jsx)("span",{className:"form-check-label",children:"View"})]}),(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-10",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",checked:null===(l=n.permissions)||void 0===l||null===(c=l.find((function(n){return n.permission_id==e.id})))||void 0===c?void 0:c.can_view_own,name:"can_view_own",disabled:1==(null===(o=n.permissions)||void 0===o||null===(u=o.find((function(n){return n.permission_id==e.id})))||void 0===u?void 0:u.can_view),onChange:function(n){return g(n,e.id)}}),(0,d.jsx)("span",{className:"form-check-label",children:"View(Own)"})]}),(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-10",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",checked:null===(m=n.permissions)||void 0===m||null===(f=m.find((function(n){return n.permission_id==e.id})))||void 0===f?void 0:f.can_create,name:"can_create",onChange:function(n){return g(n,e.id)}}),(0,d.jsx)("span",{className:"form-check-label",children:"Create"})]}),(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-10",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",checked:null===(p=n.permissions)||void 0===p||null===(h=p.find((function(n){return n.permission_id==e.id})))||void 0===h?void 0:h.can_edit,name:"can_edit",onChange:function(n){return g(n,e.id)}}),(0,d.jsx)("span",{className:"form-check-label",children:"Edit"})]}),(0,d.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-10",children:[(0,d.jsx)(W.gN,{className:"form-check-input",type:"checkbox",checked:null===(x=n.permissions)||void 0===x||null===(v=x.find((function(n){return n.permission_id==e.id})))||void 0===v?void 0:v.can_delete,name:"can_delete",onChange:function(n){return g(n,e.id)}}),(0,d.jsx)("span",{className:"form-check-label",children:"Delete"})]})]})})]},t)}))})})})]})]})},se=function(e){var n=e.role,t=e.isUserLoading,a=(0,s.useRef)(null),c=(0,s.useRef)(null),u=N().setItemIdForUpdate,m=x().refetch,f=(0,s.useState)(!1),p=(0,r.Z)(f,2),h=p[0],v=p[1],b=(0,s.useState)(ee[0]),j=(0,r.Z)(b,2),g=j[0],w=j[1],_=(0,s.useState)((0,l.Z)((0,l.Z)({},n),{},{first_name:n.first_name||K.first_name,last_name:n.last_name||K.last_name,email:n.email||K.email,password:n.password||K.password,phone_number:n.phone_number||K.phone_number,profile_image:n.profile_image||K.profile_image,admin:n.admin||K.admin,role_id:n.role_id||K.role_id,permissions:n.permissions||K.permissions})),y=(0,r.Z)(_,2),S=y[0];y[1];(0,s.useEffect)((function(){a.current&&F()}),[a]);var F=function(){c.current=k.vO.createInsance(a.current)},I=function(){c.current&&(v(c.current.currentStepIndex===c.current.totatStepsNumber-1),c.current.goPrev(),w(ee[c.current.currentStepIndex-1]))},E=function(){var e=(0,C.Z)((0,Z.Z)().mark((function e(n,t){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.current){e.next=2;break}return e.abrupt("return");case 2:if(v(c.current.currentStepIndex===c.current.totatStepsNumber-1),w(ee[c.current.currentStepIndex]),c.current.currentStepIndex===c.current.totatStepsNumber){e.next=8;break}c.current.goNext(),e.next=26;break;case 8:if(e.prev=8,!(0,i.UE)(n.id)){e.next=14;break}return e.next=12,(0,o.Nq)(n);case 12:e.next=16;break;case 14:return e.next=16,(0,o.r4)(n);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),console.error(e.t0);case 21:return e.prev=21,t.resetForm(),!0&&m(),u(void 0),P().fire({title:"Success!",text:"Staff ".concat(n.id?"Updated":"Created","!"),icon:"success",confirmButtonText:"Okay"}),e.finish(21);case 26:case"end":return e.stop()}}),e,null,[[8,18,21,26]])})));return function(n,t){return e.apply(this,arguments)}}();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{ref:a,className:"stepper stepper-links d-flex flex-column",id:"kt_create_account_stepper",children:[(0,d.jsxs)("div",{className:"stepper-nav mb-5",children:[(0,d.jsx)("div",{className:"stepper-item current","data-kt-stepper-element":"nav",children:(0,d.jsx)("h3",{className:"stepper-title",children:"Staff Info"})}),(0,d.jsx)("div",{className:"stepper-item","data-kt-stepper-element":"nav",children:(0,d.jsx)("h3",{className:"stepper-title",children:"Permissions"})})]}),(0,d.jsx)(W.J9,{validationSchema:g,initialValues:S,onSubmit:E,validateOnChange:!1,children:function(e){var n=e.setFieldValue,t=e.values,a=e.touched,r=e.setFieldError,s=e.errors;return(0,d.jsxs)(W.l0,{className:"mx-auto mw-700px w-100 pt-5 pb-10",id:"kt_create_account_form",children:[(0,d.jsx)("div",{className:"current","data-kt-stepper-element":"content",children:(0,d.jsx)(te,{setFieldValue:n,values:t,touched:a,setFieldError:r,errors:s})}),(0,d.jsx)("div",{"data-kt-stepper-element":"content",children:(0,d.jsx)(re,{setFieldValue:n,values:t})}),(0,d.jsxs)("div",{className:"d-flex flex-stack pt-15",children:[(0,d.jsx)("div",{className:"mr-2",children:(0,d.jsxs)("button",{onClick:I,type:"button",className:"btn btn-lg btn-light-primary me-3","data-kt-stepper-action":"previous",children:[(0,d.jsx)(i.D8,{path:"/media/icons/duotune/arrows/arr063.svg",className:"svg-icon-4 me-1"}),"Back"]})}),(0,d.jsx)("div",{children:(0,d.jsx)("button",{type:"submit",className:"btn btn-lg btn-primary me-3",children:(0,d.jsxs)("span",{className:"indicator-label",children:[!h&&"Continue",h&&"Submit",(0,d.jsx)(i.D8,{path:"/media/icons/duotune/arrows/arr064.svg",className:"svg-icon-3 ms-2 me-0"})]})})})]})]})}})]}),t&&(0,d.jsx)(Q,{})]})},ie=function(){var e=N(),n=e.itemIdForUpdate,t=e.setItemIdForUpdate,a=(0,i.UE)(n),r=(0,c.useQuery)("".concat(i.vb.USERS_LIST,"-permissions-").concat(n),(function(){return(0,o.GA)(n)}),{cacheTime:0,enabled:a,onError:function(e){t(void 0),console.error(e)}}),s=r.isLoading,l=r.data,u=r.error;return n?s||u||!l?null:(0,d.jsx)(se,{isUserLoading:s,role:l}):(0,d.jsx)(se,{isUserLoading:s,role:K})},le=function(){return(0,s.useEffect)((function(){return document.body.classList.add("modal-open"),function(){document.body.classList.remove("modal-open")}}),[]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"modal fade show d-block",id:"kt_modal_add_user",role:"dialog",tabIndex:-1,"aria-modal":"true",children:(0,d.jsx)("div",{className:"modal-dialog modal-dialog-centered mw-900px",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsx)(z,{}),(0,d.jsx)("div",{className:"modal-body scroll-y mx-5 mx-xl-15",children:(0,d.jsx)(ie,{})})]})})}),(0,d.jsx)("div",{className:"modal-backdrop fade show"})]})},ce=function(){var e=N().itemIdForUpdate;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(i.O7,{children:[(0,d.jsx)(A,{}),(0,d.jsx)(J,{})]}),void 0!==e&&(0,d.jsx)(le,{})]})},oe=function(){return(0,d.jsx)(m,{children:(0,d.jsx)(h,{children:(0,d.jsx)(g,{children:(0,d.jsx)(ce,{})})})})},de=[{title:"Staff management",path:"/staff",isSeparator:!1,isActive:!1},{title:"",path:"",isSeparator:!0,isActive:!1}],ue=function(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.V1,{breadcrumbs:de,children:"Staff list"}),(0,d.jsx)(oe,{})]})}},6436:function(e,n,t){t.d(n,{F3:function(){return c},GA:function(){return u},Nq:function(){return f},Rf:function(){return l},Zu:function(){return o},h8:function(){return p},mX:function(){return h},oP:function(){return d},r4:function(){return m}});var a=t(4569),r=t.n(a),s="https://quiz.datacubeindia.com/common",i="".concat(s,"/staff"),l=function(e){return r().get("".concat(i,"?").concat(e)).then((function(e){return e.data}))},c=function(){return r().get("".concat(i,"/roles")).then((function(e){return e.data}))},o=function(){return r().get("".concat(s,"/role/permissions")).then((function(e){return e.data}))},d=function(e){return r().get("".concat(i,"/checkEmail?email=").concat(e)).then((function(e){return e.data}))},u=function(e){return r().get("".concat(i,"/").concat(e)).then((function(e){return e.data})).then((function(e){return e.data}))},m=function(e){var n=new FormData,t=e.admin;return n.append("first_name",e.first_name),n.append("last_name",e.last_name),n.append("email",e.email),n.append("phone_number",e.phone_number),n.append("password",e.password),n.append("profile_image",e.profile_image),n.append("admin",t),n.append("role_id",e.role_id),n.append("permissions",JSON.stringify(e.permissions)),r().post(i,n).then((function(e){return e.data})).then((function(e){return e.data}))},f=function(e){var n=new FormData,t=e.admin;return n.append("first_name",e.first_name),n.append("last_name",e.last_name),n.append("email",e.email),n.append("phone_number",e.phone_number),n.append("password",e.password),n.append("profile_image",e.profile_image),n.append("admin",t),n.append("role_id",e.role_id),n.append("permissions",JSON.stringify(e.permissions)),r().put("".concat(i,"/").concat(e.id),n).then((function(e){return e.data})).then((function(e){return e.data}))},p=function(e){return r().delete("".concat(i,"/").concat(e)).then((function(){}))},h=function(e){var n=e.map((function(e){return r().delete("".concat(i,"/").concat(e))}));return r().all(n).then((function(){}))}}}]);
//# sourceMappingURL=454.29b7b243.chunk.js.map