"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[394],{3394:function(e,n,a){a.r(n),a.d(n,{default:function(){return y}});var s=a(885),i=a(6871),t=a(4880),l=a(2982),r=a(4165),c=a(5861),o=a(4942),d=a(1413),m=a(2791),u=a(1467),f=a(1830),p=a.n(f),h=a(2930),x=a(598),v=a(6436),b=a(1501),j=a(184),g=function(e){var n,a=e.staff,i=e.setStaff;console.log(a,"staff");var t=(0,m.useState)(!1),f=(0,s.Z)(t,2),g=f[0],N=f[1],w=(0,b.aC)(),_=w.saveAuth,k=w.setCurrentUser,y=(w.auth,(0,m.useState)([])),Z=(0,s.Z)(y,2),C=Z[0],S=Z[1],E=(0,m.useState)([]),A=(0,s.Z)(E,2),P=A[0],U=A[1],q=(0,m.useState)(),F=(0,s.Z)(q,2),D=(F[0],F[1]);(0,m.useEffect)((function(){(0,v.Zu)().then((function(e){var n;n=e.data,S(n)})).catch((function(e){console.log(e,"err")})),(0,v.F3)().then((function(e){var n;n=e.data,a.role_id&&D(n.find((function(e){return e.id==a.role_id}))),U(n)})).catch((function(e){console.log(e,"err")}))}),[]);var L=function(e){var n=e.target,s=n.name,t=n.value;i((0,d.Z)((0,d.Z)({},a),{},(0,o.Z)({},s,t)))},O=function(){var e=(0,c.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.Nq)(a);case 2:n=e.sent,_(n),k(n),p().fire({title:"Success!",text:"Profile Updated!",icon:"success",confirmButtonText:"Okay"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(e,n){var s=e.target,t=s.checked,r=s.name,c=(0,l.Z)(a.permissions),m=null===c||void 0===c?void 0:c.findIndex((function(e){return e.permission_id==n}));-1!==m?c[m]=(0,d.Z)((0,d.Z)({},c[m]),{},(0,o.Z)({},r,t)):null===c||void 0===c||c.push({permission_id:n,can_view:!("can_view"!=r||!t),can_view_own:!("can_view_own"!=r||!t),can_create:!("can_create"!=r||!t),can_edit:!("can_edit"!=r||!t),can_delete:!("can_delete"!=r||!t)}),i((0,d.Z)((0,d.Z)({},a),{},{permissions:c}))};return(0,j.jsxs)("div",{className:"row g-5 g-xxl-8",children:[(0,j.jsx)("div",{className:"col-xl-6",children:(0,j.jsx)("div",{className:"card mb-5 mb-xxl-8",children:(0,j.jsx)("div",{className:"card-body pb-0",children:(0,j.jsxs)("div",{className:"w-100",children:[(0,j.jsxs)("div",{className:"fv-row mb-7",children:[(0,j.jsx)("label",{className:"d-block form-label",children:"Avatar"}),(0,j.jsxs)("div",{className:"image-input image-input-outline","data-kt-image-input":"true",children:[(0,j.jsx)("div",{className:"",children:(0,j.jsx)("img",{src:null!==a&&void 0!==a&&null!==(n=a.profile_image)&&void 0!==n&&n.name?URL.createObjectURL(null===a||void 0===a?void 0:a.profile_image):null!=(null===a||void 0===a?void 0:a.profile_image)?null===a||void 0===a?void 0:a.profile_image:(0,h.BY)("/media/svg/avatars/blank.svg"),alt:"avatar",className:"image-input-wrapper w-125px h-125px"})}),(0,j.jsxs)("label",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change avatar",children:[(0,j.jsx)("i",{className:"bi bi-pencil-fill fs-7"}),(0,j.jsx)("input",{type:"file",name:"profile_image",accept:".png, .jpg, .jpeg",onChange:function(e){i((0,d.Z)((0,d.Z)({},a),{},{profile_image:e.currentTarget.files[0]}))}}),(0,j.jsx)("input",{type:"hidden",name:"avatar_remove"})]}),null!==a.profile_image&&(0,j.jsx)("button",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove avatar",type:"button",onClick:function(){return i((0,d.Z)((0,d.Z)({},a),{},{profile_image:null}))},children:(0,j.jsx)("i",{className:"bi bi-x fs-2"})})]}),(0,j.jsx)("div",{className:"form-text",children:"Allowed file types: png, jpg, jpeg."})]}),(0,j.jsxs)("div",{className:"fv-row w-100 mb-10",children:[(0,j.jsx)("label",{className:"form-label required",children:"First Name"}),(0,j.jsx)("input",{name:"first_name",value:null===a||void 0===a?void 0:a.first_name,onChange:L,className:"form-control mb-2",placeholder:"Enter First Name"})]}),(0,j.jsxs)("div",{className:"fv-row w-100 mb-10",children:[(0,j.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,j.jsx)("span",{className:"required",children:"Last Name"})}),(0,j.jsx)("input",{name:"last_name",value:a.last_name,className:"form-control mb-2",placeholder:"Enter Last Name",onChange:L}),(0,j.jsx)("div",{className:"text-danger mt-2"})]}),(0,j.jsxs)("div",{className:"fv-row w-100 mb-10",children:[(0,j.jsx)("label",{className:"fs-6 fw-bold form-label required",children:"Email"}),(0,j.jsx)("input",{name:"email",value:a.email,onChange:L,className:"form-control mb-2",placeholder:"Enter Valid Email"})]}),(0,j.jsxs)("div",{className:"fv-row w-100 mb-10",children:[(0,j.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,j.jsx)("span",{className:"required",children:"Phone Number"})}),(0,j.jsx)("input",{name:"phone_number",type:"number",value:a.phone_number,onChange:L,className:"form-control mb-2",placeholder:"Enter Valid Phone Number"}),(0,j.jsx)("div",{className:"text-danger mt-2"})]}),(0,j.jsxs)("div",{className:"fv-row mb-10",children:[(0,j.jsx)("label",{className:"d-flex align-items-center form-label",children:(0,j.jsx)("span",{className:"required",children:"Password"})}),(0,j.jsxs)("div",{style:{flexDirection:"row",display:"flex"},className:"mb-2 gap-5",children:[(0,j.jsxs)("div",{className:"position-relative w-100",children:[(0,j.jsx)("input",{name:"password",value:a.password,onChange:L,type:g?"text":"password",className:"form-control mb-2",placeholder:"Enter Strong Password Or Generate"}),(0,j.jsx)("button",{type:"button",onClick:function(){return N(!g)},className:"btn btn-sm btn-icon position-absolute translate-middle top-50 end-0 me-n2","data-kt-password-meter-control":"visibility",children:g?(0,j.jsx)("i",{className:"bi bi-eye fs-2"}):(0,j.jsx)("i",{className:"bi bi-eye-slash fs-2"})})]}),(0,j.jsx)("button",{type:"button",className:"btn btn-lg btn-light-primary w-50 p-0 fs-15",onClick:function(){i((0,d.Z)((0,d.Z)({},a),{},{password:Math.random().toString(36).slice(2)}))},children:"Generate Password"})]}),(0,j.jsx)(u.Z,{password:null===a||void 0===a?void 0:a.password}),(0,j.jsx)("div",{className:"text-danger"})]}),(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-15 mb-10",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",name:"admin",value:a.admin,checked:1==a.admin,onChange:function(e){i((0,d.Z)((0,d.Z)({},a),{},{admin:e.target.checked?1:0}))}}),(0,j.jsx)("span",{className:"form-check-label fs-15 fw-bold",children:"Administrator"})]}),(0,j.jsxs)("div",{className:"d-flex flex-stack mb-10",children:[(0,j.jsx)("div",{className:"mr-2"}),(0,j.jsx)("div",{children:(0,j.jsx)("button",{type:"button",onClick:O,className:"btn btn-lg btn-primary me-3",children:(0,j.jsx)("span",{className:"indicator-label",children:"Update"})})})]})]})})})}),(0,j.jsxs)("div",{className:"col-xl-6",children:[(0,j.jsx)("div",{className:"card mb-5 mb-xxl-8",children:(0,j.jsx)("div",{className:"card-body pb-0",children:(0,j.jsxs)("div",{className:"w-100",children:[(0,j.jsxs)("div",{className:"fv-row mb-10",children:[(0,j.jsx)("label",{className:"form-label required",children:"Role"}),(0,j.jsx)("select",{name:"role_id",className:"form-select mb-2","data-control":"select2","data-hide-search":"true","data-placeholder":"Select an option",children:P.map((function(e,n){return(0,j.jsx)("option",{value:e.id,children:e.name},n)}))})]}),(0,j.jsxs)("div",{className:"mb-10 fv-row",children:[(0,j.jsx)("label",{className:"fw-bold fs-6 mb-2",children:"Permissions"}),(0,j.jsx)("div",{className:"table-responsive",children:(0,j.jsx)("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:(0,j.jsx)("tbody",{className:"text-gray-600 fw-bold",children:null===C||void 0===C?void 0:C.map((function(e,n){var s,i,t,l,r,c,o,d,m,u,f,p,h,x;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"text-gray-800",children:null===e||void 0===e?void 0:e.name}),(0,j.jsx)("td",{style:{paddingLeft:35},children:(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",checked:null===(s=a.permissions)||void 0===s||null===(i=s.find((function(n){return n.permission_id==e.id})))||void 0===i?void 0:i.can_view,disabled:1==(null===(t=a.permissions)||void 0===t||null===(l=t.find((function(n){return n.permission_id==e.id})))||void 0===l?void 0:l.can_view_own),name:"can_view",onChange:function(n){return R(n,e.id)}}),(0,j.jsx)("span",{className:"form-check-label",children:"View"})]}),(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",checked:null===(r=a.permissions)||void 0===r||null===(c=r.find((function(n){return n.permission_id==e.id})))||void 0===c?void 0:c.can_view_own,name:"can_view_own",disabled:1==(null===(o=a.permissions)||void 0===o||null===(d=o.find((function(n){return n.permission_id==e.id})))||void 0===d?void 0:d.can_view),onChange:function(n){return R(n,e.id)}}),(0,j.jsx)("span",{className:"form-check-label",children:"View(Own)"})]}),(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",checked:null===(m=a.permissions)||void 0===m||null===(u=m.find((function(n){return n.permission_id==e.id})))||void 0===u?void 0:u.can_create,name:"can_create",onChange:function(n){return R(n,e.id)}}),(0,j.jsx)("span",{className:"form-check-label",children:"Create"})]}),(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",checked:null===(f=a.permissions)||void 0===f||null===(p=f.find((function(n){return n.permission_id==e.id})))||void 0===p?void 0:p.can_edit,name:"can_edit",onChange:function(n){return R(n,e.id)}}),(0,j.jsx)("span",{className:"form-check-label",children:"Edit"})]}),(0,j.jsxs)("label",{className:"form-check form-check-sm form-check-custom form-check-solid me-5",children:[(0,j.jsx)("input",{className:"form-check-input",type:"checkbox",checked:null===(h=a.permissions)||void 0===h||null===(x=h.find((function(n){return n.permission_id==e.id})))||void 0===x?void 0:x.can_delete,name:"can_delete",onChange:function(n){return R(n,e.id)}}),(0,j.jsx)("span",{className:"form-check-label",children:"Delete"})]})]})})]},n)}))})})})]}),(0,j.jsxs)("div",{className:"d-flex flex-stack mb-10",children:[(0,j.jsx)("div",{className:"mr-2"}),(0,j.jsx)("div",{children:(0,j.jsx)("button",{type:"button",onClick:O,className:"btn btn-lg btn-primary me-3",children:(0,j.jsx)("span",{className:"indicator-label",children:"Update"})})})]})]})})}),(0,j.jsx)(x.i_,{className:"mb-5 mb-xxl-8"})]})]})},N=a(9765),w=function(e){var n=e.staff;(0,i.TH)();return(0,j.jsx)("div",{className:"card mb-5 mb-xl-10",children:(0,j.jsx)("div",{className:"card-body pt-9 pb-0",children:(0,j.jsxs)("div",{className:"d-flex flex-wrap flex-sm-nowrap mb-3",children:[(0,j.jsx)("div",{className:"me-7 mb-4",children:(0,j.jsxs)("div",{className:"symbol symbol-100px symbol-lg-160px symbol-fixed position-relative",children:[(0,j.jsx)("img",{src:null!==n&&void 0!==n&&n.profile_image?n.profile_image:(0,h.BY)("/media/svg/avatars/blank.svg"),alt:"user"}),(0,j.jsx)("div",{className:"position-absolute translate-middle bottom-0 start-100 mb-6 bg-success rounded-circle border border-4 border-white h-20px w-20px"})]})}),(0,j.jsxs)("div",{className:"flex-grow-1",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-start flex-wrap mb-2",children:[(0,j.jsxs)("div",{className:"d-flex flex-column",children:[(0,j.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,j.jsxs)("a",{className:"text-gray-800 text-hover-primary fs-2 fw-bolder me-1",children:[null===n||void 0===n?void 0:n.first_name," ",null===n||void 0===n?void 0:n.last_name]}),(0,j.jsx)("a",{href:"#",children:(0,j.jsx)(h.D8,{path:"/media/icons/duotune/general/gen026.svg",className:"svg-icon-1 svg-icon-primary"})})]}),(0,j.jsxs)("div",{className:"d-flex flex-wrap fw-bold fs-6 mb-4 pe-2",children:[(0,j.jsxs)("a",{href:"#",className:"d-flex align-items-center text-gray-400 text-hover-primary me-5 mb-2",children:[(0,j.jsx)(h.D8,{path:"/media/icons/duotune/communication/com006.svg",className:"svg-icon-4 me-1"}),1==(null===n||void 0===n?void 0:n.admin)?"admin":""]}),(0,j.jsxs)("a",{href:"#",className:"d-flex align-items-center text-gray-400 text-hover-primary me-5 mb-2",children:[(0,j.jsx)(h.D8,{path:"/media/icons/duotune/general/gen018.svg",className:"svg-icon-4 me-1"}),null===n||void 0===n?void 0:n.phone_number]}),(0,j.jsxs)("a",{href:"#",className:"d-flex align-items-center text-gray-400 text-hover-primary mb-2",children:[(0,j.jsx)(h.D8,{path:"/media/icons/duotune/communication/com011.svg",className:"svg-icon-4 me-1"}),null===n||void 0===n?void 0:n.email]})]})]}),(0,j.jsx)("div",{className:"d-flex my-4",children:(0,j.jsxs)("div",{className:"me-0",children:[(0,j.jsx)("button",{className:"btn btn-sm btn-icon btn-bg-light btn-active-color-primary","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end","data-kt-menu-flip":"top-end",children:(0,j.jsx)("i",{className:"bi bi-three-dots fs-3"})}),(0,j.jsx)(N.Kz,{})]})})]}),(0,j.jsx)("div",{className:"d-flex flex-wrap flex-stack",children:(0,j.jsxs)("div",{className:"d-flex align-items-center w-200px w-sm-300px flex-column mt-3",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between w-100 mt-auto mb-2",children:[(0,j.jsx)("span",{className:"fw-bold fs-6 text-gray-400",children:"Profile Compleation"}),(0,j.jsx)("span",{className:"fw-bolder fs-6",children:"50%"})]}),(0,j.jsx)("div",{className:"h-5px mx-3 w-100 bg-light mb-3",children:(0,j.jsx)("div",{className:"bg-success rounded h-5px",role:"progressbar",style:{width:"50%"}})})]})})]})]})})})},_=a(1933),k=[{title:"Profile",path:"/crafted/pages/profile/overview",isSeparator:!1,isActive:!1},{title:"",path:"",isSeparator:!0,isActive:!1}],y=function(){var e=(0,b.aC)(),n=e.currentUser,a=(e.logout,(0,h.UE)(null===n||void 0===n?void 0:n.id)),l=(0,m.useState)(),r=(0,s.Z)(l,2),c=r[0],o=r[1],d=(0,_.useQuery)("".concat(h.vb.USERS_LIST,"-permissions-").concat(null===n||void 0===n?void 0:n.id),(function(){return(0,v.GA)(null===n||void 0===n?void 0:n.id)}),{cacheTime:0,enabled:a,onError:function(e){console.error(e)}}),u=(d.isLoading,d.data);d.error;return(0,m.useEffect)((function(){null!==u&&void 0!==u&&u.id&&o(u)}),[u]),(0,j.jsx)(i.Z5,{children:(0,j.jsxs)(i.AW,{element:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w,{staff:u}),(0,j.jsx)(i.j3,{})]}),children:[c&&(0,j.jsx)(i.AW,{path:"overview",element:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(t.V1,{breadcrumbs:k,children:"Update Profile"}),(0,j.jsx)(g,{staff:c,setStaff:o})]})}),(0,j.jsx)(i.AW,{index:!0,element:(0,j.jsx)(i.Fg,{to:"/crafted/pages/profile/overview"})})]})})}},6436:function(e,n,a){a.d(n,{F3:function(){return c},GA:function(){return m},Nq:function(){return f},Rf:function(){return r},Zu:function(){return o},h8:function(){return p},mX:function(){return h},oP:function(){return d},r4:function(){return u}});var s=a(4569),i=a.n(s),t="https://quiz.datacubeindia.com/common",l="".concat(t,"/staff"),r=function(e){return i().get("".concat(l,"?").concat(e)).then((function(e){return e.data}))},c=function(){return i().get("".concat(l,"/roles")).then((function(e){return e.data}))},o=function(){return i().get("".concat(t,"/role/permissions")).then((function(e){return e.data}))},d=function(e){return i().get("".concat(l,"/checkEmail?email=").concat(e)).then((function(e){return e.data}))},m=function(e){return i().get("".concat(l,"/").concat(e)).then((function(e){return e.data})).then((function(e){return e.data}))},u=function(e){var n=new FormData,a=e.admin;return n.append("first_name",e.first_name),n.append("last_name",e.last_name),n.append("email",e.email),n.append("phone_number",e.phone_number),n.append("password",e.password),n.append("profile_image",e.profile_image),n.append("admin",a),n.append("role_id",e.role_id),n.append("permissions",JSON.stringify(e.permissions)),i().post(l,n).then((function(e){return e.data})).then((function(e){return e.data}))},f=function(e){var n=new FormData,a=e.admin;return n.append("first_name",e.first_name),n.append("last_name",e.last_name),n.append("email",e.email),n.append("phone_number",e.phone_number),n.append("password",e.password),n.append("profile_image",e.profile_image),n.append("admin",a),n.append("role_id",e.role_id),n.append("permissions",JSON.stringify(e.permissions)),i().put("".concat(l,"/").concat(e.id),n).then((function(e){return e.data})).then((function(e){return e.data}))},p=function(e){return i().delete("".concat(l,"/").concat(e)).then((function(){}))},h=function(e){var n=e.map((function(e){return i().delete("".concat(l,"/").concat(e))}));return i().all(n).then((function(){}))}}}]);
//# sourceMappingURL=394.19d4123c.chunk.js.map